---
title: "Final Project"
name: "Makayla Ashe"
date: "12/10/19"
output:
  html_document:
    df_print: paged
  fig_width: 10
  fig_height: 6
  html_notebook: null

---
I'm examining what variables are cofounding with poverty in the United States. 

## Front Matter
```{r}
# clean up workspace environment
rm(list = ls())

# all packages used for the assignment
library(mosaic)
library(tidyverse)
library(manipulate)
library(ggplot2)
library(readxl)
library(devtools)
library(leaflet)
library(DataComputing)
library(usmap)
library(ggplot2)
library(dplyr)
library(party)
```


## Gathering Data Set 1
```{r}
library(readxl)
fooddata <- read_excel("~/Desktop/fooddata1.xlsx")
head(fooddata)
```

##Gathering Data Set 2
```{r}
mapdata<-
((usmap::us_map(regions="counties")))
```

## Cleaning Data Part 1
```{r}
#renaming and mutating
fooddata <-
  fooddata %>%
  filter(row_number() > 1)%>%
  rename(state = "State", 
         county = "County", 
         pop = 'POP2010',
         housingunits = 'OHU2010',
         lowinc = "TractLOWI",
    novehicle = 'TractHUNV',
         SNAP = 'TractSNAP')%>%
  mutate(novehicle=(novehicle/pop)*100, SNAP=(SNAP/pop)*100, lowinc=(lowinc/pop)*100, minoritypop=((TractBlack+TractAsian+TractNHOPI+TractAIAN+TractOMultir+TractHispanic)/pop)*100)
head(fooddata)
```


##Variable Selection
```{r}
#selecting
fooddata <-
  fooddata %>%
    group_by(state,county)%>%
  filter(row_number() > 1)%>%
  select(state, county, pop, housingunits, minoritypop, Urban, PovertyRate, MedianFamilyIncome, novehicle, SNAP, lowinc)
head(fooddata)
```

##Joining
```{r}
joined<-
  fooddata%>%
  full_join(mapdata)
  head(joined)
```


##Graphing
```{r}
#GRAPH1

probability1<-
  fooddata%>%
  select(pop, housingunits, Urban, PovertyRate, MedianFamilyIncome, novehicle, lowinc, SNAP, minoritypop)%>%
  na.omit()

mod1<- party::ctree(PovertyRate~Urban, data=fooddata)
plot(mod1, type="simple")
```



```{r}
#GRAPH2
fooddata %>%
  group_by(county) %>%
  filter(PovertyRate > 18)%>%
  ggplot(aes(x=minoritypop), color=blue, fill=blue) + 
  geom_density() + 
  facet_wrap(~Urban)+
  xlim(0,100)
```

```{r}
#GRAPH3
fooddata %>%
  group_by(county) %>%
  filter(minoritypop>50)%>%
  ggplot(aes(x=MedianFamilyIncome)) + 
  geom_density()
```

```{r}
#GRAPH4
fooddata %>%
  group_by(county) %>%
  filter(minoritypop<50)%>%
  ggplot(aes(x=MedianFamilyIncome)) + 
  geom_density()
```
